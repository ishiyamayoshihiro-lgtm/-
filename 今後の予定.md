# 今後の予定・TODO

## 優先度：高

### セキュリティ強化（成績改ざん対策）

**現状の問題:**
- クライアント側で採点しているため、F12コンソールで成績改ざん可能
- 満点データの偽装送信が可能
- テストの公平性に問題

**目標:**
- サーバー側（Apps Script）で採点
- JWT（Google ID Token）検証
- セッション管理（UUID、30分有効、1回限り使用）
- クライアントからは回答のみ送信

**実装内容:**
1. Apps Script側
   - 問題生成と正解データの保持
   - Google ID Token検証（tokeninfo API）
   - セッション管理（PropertiesService使用）
   - サーバー側での採点処理
   - 入力バリデーション

2. クライアント側（script.js）
   - Google ID Tokenの取得と送信
   - セッションIDの管理
   - 回答のみ送信（isCorrectは送信しない）
   - サーバーからの採点結果を受信

**未解決の課題:**
- Apps Script デプロイ時のGUIエラー（「デプロイの管理」が動作しない）
- setHeader互換性エラー（解決済み：`.setHeader()`を削除）
- 構文エラー（gas-code-clean.jsで対応）

**ファイル:**
- `gas-code-clean.js`: セキュリティ強化版コード（デプロイ準備完了）
- `デプロイ手順_完全版.md`: 詳細なデプロイ手順
- 旧版script.js: `script.js.backup`として保存済み

**次回の作業:**
1. Apps Scriptエディタでgas-code-clean.jsをデプロイ
2. 動作テスト
3. セキュリティテスト（F12でのデータ改ざんが不可能になったか確認）

---

### iPadからau回線でアクセスできるようにする（無料）

**現状:**
- ローカルサーバー（localhost）でのみ動作
- iPadからアクセス不可

**目標:**
- au回線のiPadからアクセス可能
- 完全無料で実装

**実装方法（無料オプション）:**

#### オプション1: GitHub Pages（推奨）
- ✅ 完全無料
- ✅ HTTPSあり（セキュア）
- ✅ 簡単
- ✅ どこからでもアクセス可能
- URL例: `https://username.github.io/trigonometry-test/`

**必要な作業:**
1. GitHubアカウント作成（無料）
2. リポジトリ作成
3. ファイルをアップロード
4. GitHub Pages有効化
5. Google Cloud Consoleで新しいURLを承認URLに追加

#### オプション2: Firebase Hosting
- ✅ 完全無料（無料枠内）
- ✅ HTTPSあり
- ✅ 高速
- URL例: `https://trigonometry-test.web.app/`

**必要な作業:**
1. Firebaseプロジェクト作成
2. Firebase CLI設定
3. デプロイ
4. Google Cloud Consoleで新しいURLを承認URLに追加

#### オプション3: Netlify
- ✅ 完全無料
- ✅ HTTPSあり
- ✅ ドラッグ&ドロップで簡単
- URL例: `https://trigonometry-test.netlify.app/`

**推奨: GitHub Pages**
- 最も簡単
- 設定が少ない
- 永久無料

---

## 優先度：中

### 本番運用（27問に変更）

**変更箇所:**
1. `script.js` 75行目: `let totalQuestions = 27;`
2. `index.html` 20行目: `<p>全27問</p>`

### ランキング表示機能

**目標:**
- 別ファイル（ranking.html）でランキングを表示
- スプレッドシートのデータを読み込んで自動表示
- 正答率や経過時間でソート可能

**必要な作業:**
1. ranking.html の作成
2. スプレッドシートからデータ取得用のGAS関数追加
3. ランキング表示用のJavaScript作成
4. デザイン・スタイル設定
5. GitHub Pagesにデプロイ

**URL:**
- メインページ: `https://ishiyamayoshihiro-lgtm.github.io/-/`
- ランキングページ: `https://ishiyamayoshihiro-lgtm.github.io/-/ranking.html`

**表示項目案:**
- 順位
- メールアドレス（または名前）
- 正答率
- 経過時間
- 実施日時

---

## 優先度：低

### 機能追加・改善案

#### 1. 結果のダウンロード機能
- スプレッドシートからCSVエクスポート
- 成績分析機能

#### 2. ユーザー管理
- 学校アカウントでのログイン対応
- クラス別集計

#### 3. 問題の追加・カスタマイズ
- 管理画面から問題追加
- 難易度設定

#### 4. タイマー機能
- 制限時間設定オプション
- カウントダウン表示

#### 5. 統計機能
- 正答率グラフ
- 平均点表示
- 問題別正答率

---

## メモ

### 現在の状態
- ✅ ローカル環境で動作確認済み
- ✅ スプレッドシート連携成功
- ✅ Googleログイン機能動作
- ✅ iPad対応（完了）
- ✅ GitHub Pages公開完了

### 設定済み情報
- Google Cloud Platform: 個人アカウント
- OAuth クライアントID: 設定済み
- Apps Script: デプロイ済み
- スプレッドシート: 自動記録設定済み
- GitHub Pages: 公開済み

### 承認済みURL
- `http://localhost:8000`
- `https://ishiyamayoshihiro-lgtm.github.io`

### 公開URL
- メインページ: `https://ishiyamayoshihiro-lgtm.github.io/-/`

---

## 実装スケジュール案

### フェーズ1: iPad対応（無料ホスティング）
1. GitHub Pagesに登録
2. ファイルをアップロード
3. Google Cloud Consoleで新URLを承認
4. iPadでテスト

**所要時間:** 30分〜1時間

### フェーズ2: 本番運用（27問）
1. `script.js` 編集
2. `index.html` 編集
3. 動作テスト

**所要時間:** 5分

### フェーズ3: 追加機能（オプション）
必要に応じて実装

---

**作成日: 2025年10月23日**
